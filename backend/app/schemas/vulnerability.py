from pydantic import BaseModel, Field
from typing import Optional, Dict, Any
from uuid import UUID
from datetime import datetime

class VulnerabilityResponse(BaseModel):
    id: UUID
    title: str
    description: Optional[str]
    type: str
    severity: str
    risk_score: float
    host: Optional[str]
    port: Optional[int]
    service: Optional[str]
    remediation: Optional[str]
    evidence: Optional[Dict[str, Any]]
    cvss_score: Optional[float]
    cve_id: Optional[str]
    cwe_id: Optional[str]
    detected_at: Optional[datetime]
    is_resolved: bool
    resolution_notes: Optional[str]
    resolved_at: Optional[datetime]

    class Config:
        orm_mode = True